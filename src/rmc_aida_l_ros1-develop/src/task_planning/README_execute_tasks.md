# ä»»åŠ¡æ‰§è¡Œè„šæœ¬ä½¿ç”¨è¯´æ˜

## æ¦‚è¿°

`execute_tasks.py` æ˜¯ä¸€ä¸ªæ•´åˆäº†AGVã€æœºæ¢°è‡‚å’Œå¤¹çˆªæ§åˆ¶çš„ä¸»æ‰§è¡Œè„šæœ¬ï¼Œç”¨äºæ¼”ç¤ºå®Œæ•´çš„æœºå™¨äººä»»åŠ¡æ‰§è¡Œæµç¨‹ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ¤– æ•´åˆçš„å®¢æˆ·ç«¯
- **AGVå®¢æˆ·ç«¯** (`agv_client.py`) - AGVå¯¼èˆªæ§åˆ¶
- **æœºæ¢°è‡‚å®¢æˆ·ç«¯** (`arm_client.py`) - åŒè‡‚å…³èŠ‚å’Œç©ºé—´è¿åŠ¨æ§åˆ¶  
- **å¤¹çˆªå®¢æˆ·ç«¯** (`gripper_client.py`) - åŒå¤¹çˆªä½ç½®æ§åˆ¶

### ğŸ¯ æ¼”ç¤ºä»»åŠ¡
1. **AGVå¯¼èˆªæ¼”ç¤º** - å‘é€å¯¼èˆªä»»åŠ¡åˆ°æŒ‡å®šç‚¹ä½
2. **æœºæ¢°è‡‚æ§åˆ¶æ¼”ç¤º** - åŒè‡‚å›é›¶ç‚¹å’Œå…³èŠ‚è¿åŠ¨
3. **å¤¹çˆªæ§åˆ¶æ¼”ç¤º** - å¤¹çˆªå¼€åˆå’Œä½ç½®è®¾ç½®
4. **åè°ƒä»»åŠ¡æ¼”ç¤º** - å¤šç³»ç»Ÿé…åˆçš„å®Œæ•´æŠ“å–æ”¾ç½®æµç¨‹

## ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•1: é€šè¿‡Launchæ–‡ä»¶å¯åŠ¨ï¼ˆæ¨èï¼‰

```bash
# å¯åŠ¨å®Œæ•´ç³»ç»Ÿï¼ˆåŒ…æ‹¬æ‰€æœ‰æ§åˆ¶èŠ‚ç‚¹ï¼‰
roslaunch task_planning execute_tasks.launch

# å¯ç”¨è°ƒè¯•æ¨¡å¼
roslaunch task_planning execute_tasks.launch debug:=true

# æŒ‡å®šè¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶
roslaunch task_planning execute_tasks.launch output:=log

# åªå¯åŠ¨ä»»åŠ¡æ‰§è¡ŒèŠ‚ç‚¹ï¼ˆä¸å¯åŠ¨æ§åˆ¶èŠ‚ç‚¹ï¼‰
roslaunch task_planning execute_tasks.launch start_control_nodes:=false
```

### æ–¹æ³•2: ç›´æ¥è¿è¡ŒPythonè„šæœ¬

```bash
# ç¡®ä¿åœ¨ROSç¯å¢ƒä¸­
source /opt/ros/noetic/setup.bash
source ~/catkin_ws/devel/setup.bash  # æ›¿æ¢ä¸ºä½ çš„å·¥ä½œç©ºé—´

# è¿è¡Œè„šæœ¬
rosrun task_planning execute_tasks.py
```

## å‰ç½®æ¡ä»¶

### è‡ªåŠ¨å¯åŠ¨æ¨¡å¼ï¼ˆæ¨èï¼‰
ä½¿ç”¨ `roslaunch task_planning execute_tasks.launch` ä¼šè‡ªåŠ¨å¯åŠ¨æ‰€æœ‰å¿…éœ€çš„æ§åˆ¶èŠ‚ç‚¹ï¼š
- AGVæ§åˆ¶èŠ‚ç‚¹
- æœºæ¢°è‡‚æ§åˆ¶èŠ‚ç‚¹  
- å¤¹çˆªæ§åˆ¶èŠ‚ç‚¹

### æ‰‹åŠ¨å¯åŠ¨æ¨¡å¼
å¦‚æœä½¿ç”¨ `start_control_nodes:=false` æˆ–ç›´æ¥è¿è¡ŒPythonè„šæœ¬ï¼Œéœ€è¦æ‰‹åŠ¨å¯åŠ¨ä»¥ä¸‹æœåŠ¡ï¼š

1. **AGVæ§åˆ¶æœåŠ¡**
   ```bash
   roslaunch agv_control_handler agv_control.launch
   ```

2. **æœºæ¢°è‡‚æ§åˆ¶æœåŠ¡**
   ```bash
   roslaunch arm_control_handler arm_control.launch
   ```

3. **å¤¹çˆªæ§åˆ¶æœåŠ¡**
   ```bash
   roslaunch gripper_control_handler gripper_control.launch
   ```

### ROSè¯é¢˜å’ŒæœåŠ¡
è„šæœ¬ä¼šè¿æ¥åˆ°ä»¥ä¸‹ROSæ¥å£ï¼š
- `/navigation_task` - AGVå¯¼èˆªä»»åŠ¡å‘å¸ƒ
- `/agv_task_status` - AGVçŠ¶æ€åé¦ˆè®¢é˜…
- `movej_control` - æœºæ¢°è‡‚å…³èŠ‚è¿åŠ¨Action
- `movepose_control` - æœºæ¢°è‡‚ç©ºé—´è¿åŠ¨Action
- `gripper_set_position_left` - å·¦å¤¹çˆªæ§åˆ¶Action
- `gripper_set_position_right` - å³å¤¹çˆªæ§åˆ¶Action

## è„šæœ¬ç»“æ„

### TaskExecutorç±»
ä¸»è¦çš„ä»»åŠ¡æ‰§è¡Œå™¨ç±»ï¼ŒåŒ…å«ä»¥ä¸‹æ–¹æ³•ï¼š

- `__init__()` - åˆå§‹åŒ–æ‰€æœ‰å®¢æˆ·ç«¯
- `demo_agv_navigation()` - AGVå¯¼èˆªæ¼”ç¤º
- `demo_arm_control()` - æœºæ¢°è‡‚æ§åˆ¶æ¼”ç¤º
- `demo_gripper_control()` - å¤¹çˆªæ§åˆ¶æ¼”ç¤º
- `demo_coordinated_task()` - åè°ƒä»»åŠ¡æ¼”ç¤º
- `execute_all_demos()` - æ‰§è¡Œæ‰€æœ‰æ¼”ç¤ºä»»åŠ¡

### æ‰§è¡Œæµç¨‹
1. åˆå§‹åŒ–æ‰€æœ‰å®¢æˆ·ç«¯è¿æ¥
2. æŒ‰åºæ‰§è¡Œå„ä¸ªå­ç³»ç»Ÿæ¼”ç¤º
3. æœ€åæ‰§è¡Œåè°ƒä»»åŠ¡æ¼”ç¤º
4. ä¿æŒèŠ‚ç‚¹è¿è¡ŒçŠ¶æ€

## è¾“å‡ºæ—¥å¿—

è„šæœ¬ä¼šè¾“å‡ºè¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—ï¼ŒåŒ…æ‹¬ï¼š
- âœ… æˆåŠŸæ“ä½œæ ‡è¯†
- âŒ é”™è¯¯æ“ä½œæ ‡è¯†
- âš ï¸ è­¦å‘Šä¿¡æ¯æ ‡è¯†
- ğŸ“¡ é€šä¿¡çŠ¶æ€ä¿¡æ¯
- ğŸ¤– æœºå™¨äººåŠ¨ä½œä¿¡æ¯

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **å®¢æˆ·ç«¯è¿æ¥å¤±è´¥**
   - æ£€æŸ¥ç›¸åº”çš„æ§åˆ¶æœåŠ¡æ˜¯å¦å¯åŠ¨
   - ç¡®è®¤ROS_MASTER_URIè®¾ç½®æ­£ç¡®
   - éªŒè¯ç½‘ç»œè¿æ¥çŠ¶æ€

2. **åŠ¨ä½œæ‰§è¡Œå¤±è´¥**
   - æ£€æŸ¥ç¡¬ä»¶è¿æ¥çŠ¶æ€
   - ç¡®è®¤æœºå™¨äººå¤„äºå®‰å…¨ä½ç½®
   - æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—

3. **è¶…æ—¶é”™è¯¯**
   - å¢åŠ åŠ¨ä½œè¶…æ—¶æ—¶é—´
   - æ£€æŸ¥ç¡¬ä»¶å“åº”é€Ÿåº¦
   - ç¡®è®¤ç³»ç»Ÿè´Ÿè½½æƒ…å†µ

### è°ƒè¯•æ¨¡å¼
å¯ç”¨è°ƒè¯•æ¨¡å¼å¯è·å¾—æ›´è¯¦ç»†çš„æ—¥å¿—ä¿¡æ¯ï¼š
```bash
roslaunch task_planning execute_tasks.launch debug:=true
```

## è‡ªå®šä¹‰ä»»åŠ¡

å¯ä»¥åœ¨ `TaskExecutor` ç±»ä¸­æ·»åŠ è‡ªå®šä¹‰çš„ä»»åŠ¡æ–¹æ³•ï¼š

```python
def custom_task(self):
    """è‡ªå®šä¹‰ä»»åŠ¡"""
    rospy.loginfo("ğŸ¯ æ‰§è¡Œè‡ªå®šä¹‰ä»»åŠ¡...")
    
    # è°ƒç”¨å„ä¸ªå®¢æˆ·ç«¯çš„æ–¹æ³•
    self.agv_client.send_navigation_task("CUSTOM_POINT")
    self.arm_client.move_joint("left", [0, 0, 0, 0, 0, 0, 0])
    self.gripper_client.set_gripper_position("left", 5000)
    
    rospy.loginfo("âœ… è‡ªå®šä¹‰ä»»åŠ¡å®Œæˆ")
```

## æ–‡ä»¶ç»“æ„

```
task_planning/
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ agv_client.py          # AGVæ§åˆ¶å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ arm_client.py          # æœºæ¢°è‡‚æ§åˆ¶å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ gripper_client.py      # å¤¹çˆªæ§åˆ¶å®¢æˆ·ç«¯
â”‚   â””â”€â”€ execute_tasks.py       # ä¸»ä»»åŠ¡æ‰§è¡Œè„šæœ¬
â”œâ”€â”€ launch/
â”‚   â””â”€â”€ execute_tasks.launch   # Launchå¯åŠ¨æ–‡ä»¶
â””â”€â”€ README_execute_tasks.md    # ä½¿ç”¨è¯´æ˜æ–‡æ¡£
```

## è”ç³»ä¿¡æ¯

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿã€‚
